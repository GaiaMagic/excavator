# don't use `fig build` or `fig up` manually, use `make`

# data-only container
data:
  image: busybox:latest
  volumes:
    - /data/db

# mongodb
# remember to also update excavator.js if you change this service name
db:
  image: mongo:2.6.5
  volumes_from:
    - data

# backend
backend:
  build: .
  links:
    - db
  ports:
    - '43210:3000'

# frontend
frontend:
  build: .
  environment:
    - GIT_HEAD_COMMIT
    - GIT_HEAD_DATE
    - GIT_HEAD_AUTHOR
    - GIT_HEAD_FILE_COUNT
    - GIT_USER
  volumes:
    - /srv/excavator:/excavator/dist
